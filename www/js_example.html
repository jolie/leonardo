<html>

<body>
  <div>
    <input type="text" id="item">
    <input type="button" value="Add item" id="add">
    <input type="button" value="Send message" id="send">
    <label id ="status"></label>
    <label id ="response"></label>
    <script type="text/javascript">
      var messageToBeSent = {
        item: new Array()
      }
      document.onreadystatechange = function() {
        var state = document.readyState;
        if (state == 'complete') {
          var addButton = document.getElementById('add');
          addButton.onclick = function() {
            messageToBeSent.item.push(document.getElementById('item').value)
          }


          var sendButton = document.getElementById('send');
          sendButton.onclick = function() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/length');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function() {
              if (xhr.status === 200) {
                var response = JSON.parse(xhr.responseText);
                document.getElementById('status').textContent= response.$
              }
              if (xhr.status === 500){
                var errorResponse = JSON.parse(xhr.responseText)
                document.getElementById('status').textContent=  errorResponse.error.message
              }
            };
            xhr.send(JSON.stringify(messageToBeSent));
          }

        }
      }
    </script>
</body>

</html>
